package jsonu

import (
	"testing"

	"github.com/stretchr/testify/assert"
)

func TestStringToLong(t *testing.T) {
	s1 := `{"ArrI1":["18014398509481985","18014398509481985","18014398509481985","18014398509481985"],"ArrM1":[{"F64":0.1,"I":1,"I64":"18014398509481985","Str":"134124"}],"F64":0.1,"I":1,"I64":"18014398509481985","M1":{"F64":0.1,"I":1,"I64":"18014398509481985","Str":"134124"},"Str":"134124"}`
	ex := `{"ArrI1":[18014398509481985,18014398509481985,18014398509481985,18014398509481985],"ArrM1":[{"F64":0.1,"I":1,"I64":18014398509481985,"Str":"134124"}],"F64":0.1,"I":1,"I64":18014398509481985,"M1":{"F64":0.1,"I":1,"I64":18014398509481985,"Str":"134124"},"Str":"134124"}`
	bs1 := []byte(s1)
	bs2, err := StringToLong(bs1)
	assert.Equal(t, nil, err)
	s2 := string(bs2)
	assert.Equal(t, ex, s2)
}

func TestLongToString(t *testing.T) {
	s1 := `{"ArrI1":[18014398509481985,18014398509481985,18014398509481985,18014398509481985],"ArrM1":[{"F64":0.1,"I":1,"I64":18014398509481985,"Str":"134124"}],"F64":0.1,"I":1,"I64":18014398509481985,"M1":{"F64":0.1,"I":1,"I64":18014398509481985,"Str":"134124"},"Str":"134124"}`
	ex := `{"ArrI1":["18014398509481985","18014398509481985","18014398509481985","18014398509481985"],"ArrM1":[{"F64":0.1,"I":1,"I64":"18014398509481985","Str":"134124"}],"F64":0.1,"I":1,"I64":"18014398509481985","M1":{"F64":0.1,"I":1,"I64":"18014398509481985","Str":"134124"},"Str":"134124"}`
	bs1 := []byte(s1)
	bs2, err := LongToString(bs1)
	assert.Equal(t, nil, err)
	s2 := string(bs2)
	assert.Equal(t, ex, s2)
}
